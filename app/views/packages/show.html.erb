<script>
  $(document).ready(function () {
    reposition_tiles('masonry', 'masonry-brick');
  })
</script>

<%- model_class = Package -%>
<div class="row wrapper">
  <!-- SIDEBAR -->
  <div class="col-md-3 col-xs-3" id="sidebar">
    <%= render :partial => "packages/partials/package_info", :locals => {:package => @package} %>
  </div>
  <div class=" col-md-9 col-xs-9">
    <div class="row">
      <div class="content_action">
        <%= link_to t('.back', :default => t("helpers.links.back")),
                    package_path, :class => 'btn btn-info' %>
        <% if !current_user.nil? and policy(@package).update? %>
            <%= link_to t('.edit', :default => t("helpers.links.edit")),
                        edit_package_path(@package), :class => 'btn btn-primary' %>
        <% end %>
        <% if !current_user.nil? and policy(@package).manage? %>
            <%= link_to t('.manage', :default => t("helpers.links.manage")),
                        package_manage_path(@package), :class => 'btn btn-default' %>
        <% end %>
        <% if !current_user.nil? and policy(@package).destroy? %>
            <%= link_to t('.destroy', :default => t("helpers.links.destroy")),
                        package_path(@package),
                        :method => 'delete',
                        :data => {:confirm => t('.confirm', :default => t("helpers.links.confirm", :default => 'Are you sure?'))},
                        :class => 'btn btn-danger' %>
        <% end %>
      </div>

      <ul class="nav nav-tabs">
        <li class="active">
          <a data-toggle="tab" href="#materials"><i class="<%= icon_class_for_model('materials') %>"></i> Materials</a></li>
        <li>
          <a data-toggle="tab" href="#events"><i class="<%= icon_class_for_model('events') %>"></i> Events</a>
        </li>
        <li>
          <a data-toggle="tab" href="#activity_log"><i class="<%= icon_class_for_model('activity_logs') %>"></i> Activity log</a>
        </li>
      </ul>
    </div>

    <div class="tab-content">
      <div id="materials" class="tab-pane fade in active">
        <div class="row">
          <div class="search-results-count"> 
            <%= pluralize(@package.materials.count, 'training material') %> found 
          </div>
          <% @package.materials.each do |material| %>
              <%= render material %>
          <% end %>
        </div>
      </div>
      <div id="events" class="tab-pane fade">
        <div class="row">
          <div class="search-results-count"> 
            <%= pluralize(@package.events.count, 'event') %> found 
          </div>
          <% unless @package.events.count == 0 %>
              <div class="masonry media-grid">
                <% @package.events.each do |event| %>
                    <%= render event %>
                <% end %>
              </div>
          <% end %>
        </div>
      </div>
      <div id="activity_log" class="tab-pane fade">
        <%= render :partial => "activities/activity_log", :locals => {:resource => @package} %>
      </div>
    </div>
  </div>
</div>

