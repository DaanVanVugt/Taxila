<%# Sidebar containing filterable facets.

Parameters:
- resources     - SOLR object containing results and metadata about search as returned from materials#index

Variable that should be available
- @facet_params  - The facet filters the user has applied
%>
<h3 class="nav-heading" id="sidebar-header">
  <i class="fa fa-filter"></i> Filters
  <button href="#" class="btn btn-link pull-right" id="sidebar-close"><i class="icon-lg icon cross-icon icon-invert"></i></button>
</h3>

<% if ['Event'].include?(resource_type.name) %>
  <%= render partial: "search/common/sort_by",
             locals: { resources: resource_type, extras: [['Most recent', 'new'], ['Earliest', 'early'], ['Latest', 'late']] } %>
<% else %>
  <%= render partial: "search/common/sort_by",
             locals: { resources: resource_type, extras: [['Most recent', 'new']] } %>
<% end %>

<ul class="unstyled nav-simple">
  <li>
    <h3>Filter<i class="icon icon-md clear-filters-icon pull-right"></i><span class="font-size-sm pull-right"><a class="no-link" href="#FIXME">clear filters</a></span></h3>
  </li>
  <% if current_user && (current_user.is_curator? || current_user.is_admin?) %>
    <%= render partial: 'search/common/facet_sidebar_curation', locals: { resource_type: resource_type } %>
  <% end %>
  <% if ['Event', 'Material'].include?(resource_type.name) %>
    <%= render partial: 'search/common/facet_sidebar_max_age' %>
  <% end %>
  <% resources.facets.select { |f| f.rows.any? }.each do |facet| %>
      <% if IGNORED_FILTERS.include?(facet.field_name.to_s)   %>
      <% elsif facet.field_name == :online %>
      <% elsif facet.field_name == :include_expired %>


      <% else %>
        <%= render partial: 'search/common/facet_sidebar_filter',
                 locals: { facet: facet, resources: resources } %>
      <% end %>
  <% end %>

  <% resources.facets.select { |f| f.rows.any? }.each do |facet| %>
    <% if facet.field_name == :online %>
      <%= render partial: 'search/common/facet_sidebar_boolean_filter',
                 locals: { facet: facet, resources: resources } %>
    <% end %>

  <% end %>

  <% if ['Event'].include?(resource_type.name) %>
    <!-- FIXME: show past events toggle using Ruby on Rails functionality, see _facet_sidebar_boolean_filter.html.erb -->
    <div class="toggle-wrap">
      <a href="#FIXME">
          <li class="nav-item">
            <label class="toggle">
              <input type="checkbox">
              <span class="slider round"></span>
            </label>
            Show expired events
          </li>
      </a>
    </div>
  <% end %>
</ul>
