<script>
  $(document).ready(function () {
    reposition_tiles('masonry', 'masonry-brick');
  })
</script>

<!-- SIDEBAR | RESULTS -->
<div class="row">
  <% if SOLR_ENABLED %>

      <!-- SIDEBAR -->
      <% if @events.results.empty? %>
          <div class="col-md-3">
            <p class="alert alert-info empty">
              No events to filter
            </p>
          </div>
      <% else %>
          <div class="col-md-3">
            <%= render :partial => "search/common/facet_sidebar", :locals => {:resources => @events} %>
          </div>
      <% end %>

      <!-- RESULTS -->
      <div class="col-md-9">

        <!-- CREATE NEW BUTTON -->
        <div class="row">
          <%= link_to new_event_path, :class => "btn btn-primary" do %>
              <i class="fa fa-plus-square"></i> Create event
          <% end %>
        </div>

        <!-- SEARCH BAR -->
        <div class="row">
          <%= render :partial=> "search/common/search_box", :locals=>{:resource_path => events_path} %>
        </div>

        <!-- APPLIED FILTERS AND NUMBER OF RESULTS -->
        <div class="row">
          <% include_expired = @facet_params.delete('include_expired') %>
          <div class="col-md-4">
            <%= render :partial => "search/common/search_info", :locals=>{:resources=>@events}  %>
          </div>
          <!-- INCUDE EXPIRED EVENTS -->
          <div class="col-md-4">
            <% if include_expired == true %>
                <%= link_to 'Exclude past events', events_path, :class => 'include_expired' %>
            <% else %>
                <%= link_to 'Include past events', events_path(:include_expired => true), :class => 'include_expired' %>
            <% end %>
          </div>
          <!-- SORT BY OPTIONS    -->
          <div class="col-md-4">
            <%= render :partial => "search/common/sort_by",
                       :locals => {:resources => @events,
                                   :extras => [['Earliest', 'early'], ['Latest', 'late']]} %>
          </div>
        </div>

        <%#= render :partial=> "search/common/pagination_bar", :locals=>{:resources=>@materials} %>
        <hr>
        <% @events = @events.results %>
  <% end %>

  <% unless @events.blank? %>
    <%= render :partial => "tab_headings", :locals => {:selected_tab => "grid"} %>
    <!-- ACTUAL RESULTS LIST -->
    <div id="grid-content" class="tab-content">
      <ul class="masonry media-grid">
        <% @events.each do |event| %>
            <%= render event %>
        <% end %>
      </ul>
    </div>

    <!-- Alternative Map view -->
    <div id="map-content" class="tab-content">
      <%= render :partial => "map_view", :locals => {:events => @events} %>
    </div>
  <% end %>
  </div>
</div>
