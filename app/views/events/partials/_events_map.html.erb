<div style="width: 100%; height: 750px; margin-top: 10px; display: none" id="map-canvas"></div>
<div id='map-loading-screen'>
  <%= image_tag('ajax-loader2.gif') %>
</div>

<script>
function initialize(){
    $('#map-canvas').hide();
    $('#map-loading-screen').fadeIn();

    $.ajax({
        type: 'GET',
        url: '<%= events_url(params.slice(:q, :include_expired, *Event.facet_fields).merge(format: :json_api)).html_safe -%>',
        dataType: 'json',
    }).done(function (res) {
        plotEvents(res.data)
    }).fail(function (error) {
        console.log("Error: " + error);
    });

    var mapOptions = {
        zoom: 10,
        center: new google.maps.LatLng(0, 0)
    };

    map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

    loadedMapScript = true;
}
</script>
