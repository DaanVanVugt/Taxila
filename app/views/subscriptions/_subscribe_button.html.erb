<div class="btn-group">
  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Subscribe <span class="caret"></span>
  </button>
  <ul class="dropdown-menu">
    <% if user_signed_in? %>
        <li>
          <a href="#" data-toggle="modal" data-target="#subscribe-email-modal">
            <i class="fa fa-envelope-o"></i> Subscribe via email
          </a>
        </li>
    <% end %>
    <% if type == 'Event' %>
        <li>
          <a href="#" data-toggle="modal" data-target="#subscribe-calendar-modal">
            <i class="fa fa-calendar-o"></i> Add to calendar
          </a>
        </li>
    <% end %>
  </ul>
</div>

<div class="modal fade" tabindex="-1" role="dialog" aria-labelledby="subscribe-email-modal-title" id="subscribe-email-modal">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title" id="subscribe-email-modal-title">Email Subscription</h4>
      </div>

      <div class="modal-body">
        <%= form_tag(subscriptions_path(params)) do %>
            <%= hidden_field_tag('subscription[subscribable_type]', type) %>
            <div class="form-group">
              <label for="frequency">Frequency</label>
              <%= select_tag('subscription[frequency]', frequency_options_for_select, class: 'form-control', autocomplete: 'off') %>
            </div>
            <%= submit_tag('Subscribe', class: 'btn btn-primary') %>
        <% end %>
      </div>
    </div>
  </div>
</div>

<%= render partial: 'subscriptions/subscribe_to_calendar_modal' if type == 'Event' %>
