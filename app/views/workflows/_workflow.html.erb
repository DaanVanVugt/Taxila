<div class="wrapper" id="cy"></div>
<script>
  <%# TODO: Move all this into a special JS file. Render the workflow as JSON in a script element, and load via JS %>
  $(document).ready(function () {
    var cy = window.cy = cytoscape({
      container: document.getElementById('cy'),
      elements: <%= workflow.workflow_content['elements'].to_json.html_safe %>,
      layout: {
        name: 'preset',
        padding: 50
      },
      style: [
        {
          selector: 'node',
          css: {
            'shape': 'roundrectangle',
            'content': 'data(short_name)',
            'background-color': 'data(color)',
            'text-valign': 'center',
            'text-halign': 'center',
            'width': 100,
            'height': 50,
            'font-size': 12,
            'border-width': '1',
            'border-color': '#999'
          }
        },
        {
          selector: '$node > node',
          css: {
            'shape': 'roundrectangle',
            'padding-top': '10px',
            'font-weight': 'bold',
            'padding-left': '10px',
            'padding-bottom': '10px',
            'padding-right': '10px',
            'text-valign': 'top',
            'text-halign': 'center',
            'width': 'auto',
            'height': 'auto',
            'font-size': 12
          }
        },
        {
          selector: 'edge',
          css: {
            'target-arrow-shape': 'triangle',
            'content': 'data(short_name)',
            'line-color': '#ff0000',
            'source-arrow-color': '#ff0000',
            'target-arrow-color': '#ff0000',
            'font-size': 12
          }
        },
        {
          selector: ':selected',
          css: {
            'background-color': 'data[\'color\'])',
            'line-color': '#0000ff',
            //'width': '5',
            //'line-style': 'dotted',
            'target-arrow-color': '#0000ff',
            'source-arrow-color': '#0000ff',
            'border-width': '7',
            'border-color': '#0000ff',//'#999',
            'background-blacken': '0.3'
          }
        }
      ],
      userZoomingEnabled: false
    });

    cy.panzoom();
  });
</script>